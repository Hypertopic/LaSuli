<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<title>Hypertopic JavaScript Library</title>

		<link type="text/css" href="css/blitzer/jquery-ui-1.8.4.custom.css" rel="stylesheet" />
		<link type="text/css" href="css/lasuli.css" rel="stylesheet" />
		<link type="text/css" href="css/ui.jqgrid.css" rel="stylesheet" />

		<script type="text/javascript" src="js/jquery-1.4.2.min.js"></script>
		<script type="text/javascript" src="js/jquery-ui-1.8.4.custom.min.js"></script>

		<link type="text/css" href="css/jquery.contextMenu.css" rel="stylesheet" />
		<script type="text/javascript" src="js/jquery.contextMenu.js"></script>
		<script type="text/javascript" src="js/jquery.tinysort.js"></script>
		<script type="text/javascript" src="js/jquery.easing.1.3.js"></script>
    <script type="text/javascript" src="js/jquery.jstree.js"></script>

		<script type="text/javascript" src="js/HypertopicMap.js"></script>

		<script type="text/javascript" src="js/jquery.jsonview.js"></script>
    <link type="text/css" rel="stylesheet" href="css/jquery.jsonview.css">

    <style type="text/css" media="screen">
  		body{background:#f5f9f5; overflow:auto; margin-left: 15px;}
  		.jsonview{
  			border:1px solid #787;overflow:auto; width: 80%;
  			-moz-border-radius:8px;-webkit-border-radius:8px;border-radius:8px;padding:10px;bottom:10%;
  			-moz-box-shadow:3px 3px 6px #ccc;-webkit-box-shadow:3px 3px 6px #ccc;box-shadow:3px 3px 6px #ccc;
  			background:#fff;
  			margin: 0px 5px 5px 5px;
  		}
  	</style>

  	<script language="javascript">

  	  var map, user, corpus, item, highlight, viewpoint, topic, childTopic, otherTopic;

      function test(){
        map = new HtMap('http://127.0.0.1/argos/_design/argos/_rewrite/', '','');
        user = map.getUser("me");
        corpus = user.createCorpus("my corpus");
        item = corpus.createItem("my item");
        item.describe("foo", "bar");
        item.describe("resource", "http://acme.com/foo");
        viewpoint = user.createViewpoint("my viewpoint");
	      topic = viewpoint.createTopic();
	      childTopic = viewpoint.createTopic(topic);
	      otherTopic = viewpoint.createTopic();
	      highlight = item.createHighlight(
		      childTopic, "FOO", 1024, 1096
	      );
	      item.tag(childTopic);
	      h3("User");
        json(user.getObject());
        h3("Corpus");
        json(corpus.getObject());
        h3("Item");
	      json(item.getObject());
	      h3("Viewpoint");
	      json(viewpoint.getObject());

        var userHim = map.getUser("him");
        corpus.register(userHim);
        h3("Corpus");
        json(corpus.getObject());
        h3("Corpus.listUsers()");
        json(corpus.listUsers());

        corpus.unregister(user);
        json(corpus.listUsers());
        corpus.rename("new name");
        h3("corpus rename");
        json(corpus.getName());

        h3("corpus.destroy()");
        json(corpus.destroy());
        /*h3("htMapUser.createCorpus('test corpus')");
        json(htMapUser.createCorpus('test corpus'));
        h3("htMapUser.createViewpoint('test viewpoint')");
        json(htMapUser.createViewpoint('test viewpoint'));
        h3("htMapUser.listCorpora()");
        json(htMapUser.listCorpora());
        h3("htMapUser.listViewpoints()");
        json(htMapUser.listViewpoints());*/
      }
      function json(obj)
      {
        var div;
        if(typeof(obj) == "string")
          try{
            obj = JSON.parse(obj);
            div = $('<div class="jsonview"></div>').jsonView(obj);
          }catch(e){
            div = $('<div class="jsonview"></div>').html(obj);
          }
        else
          div = $('<div class="jsonview"></div>').jsonView(obj);
        $('#result').append(div);
      }
      function h3(str)
      {
        var div = $('<h3></h3>').html(str);
        $('#result').append(div);
      }

    </script>
	</head>
<body id="result">
<input type="button" onclick="test()" value="enable">
<!--<input type="button" onclick="Observers.notify('lasuli.contextmenu.doHide', null);" value="disable"> //-->
</body>
</html>